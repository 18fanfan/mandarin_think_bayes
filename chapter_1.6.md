## 章節 1：貝葉斯定理（Bayes's Theorem）

### 1.6 M&M 巧克力問題

M&M's 是一種小小的裹著繽紛糖衣的巧克力。美商瑪氏食品（Mars Inc.）會隨時間製造不同顏色混合比例的 M&M's 。

在 1995 以前 M&M's 的顏色混合比例是：

<table border=1>
<tr><td>棕色</td><td>30%</td></tr>
<tr><td>黃色</td><td>20%</td></tr>
<tr><td>紅色</td><td>20%</td></tr>
<tr><td>綠色</td><td>10%</td></tr>
<tr><td>橘色</td><td>10%</td></tr>
<tr><td>黃褐色</td><td>10%</td></tr>
</table>

1995 年他們推出了藍色的 M&M's 。在 1995 年之後 M&M's 的顏色混合比例是：

<table border=1>
<tr><td>藍色</td><td>24%</td></tr>
<tr><td>綠色</td><td>20%</td></tr>
<tr><td>橘色</td><td>16%</td></tr>
<tr><td>黃色</td><td>14%</td></tr>
<tr><td>棕色</td><td>13%</td></tr>
<tr><td>紅色</td><td>13%</td></tr>
</table>

假設我有一個朋友他有兩包 M&M's 分別是製造於 1994 年以及 1996 年。他不會跟我說各自的正確年份，但給我一顆 M&M 分別來自兩包 M&M's 。一顆是黃色，另一顆是綠色。請問黃色來自 1994 年的巧克力包機率是多少？

這個問題很類似餅乾問題，但這邊有從兩包中各自取一個樣本。這個例子讓我有機會介紹表格方法（table method）；這對解決這種紙上的問題很實用。在第二章我們用電腦計算的方式來解此問題。

第一步：列出所有假設。

* A：包1 是 1994 年， 包2 是 1996 年
* B：包1 是 1996 年， 包2 是 1994 年

第二部：建立一個表格，計算貝葉斯定理等式右方的所有項目。

<table border=1>
<tr><td>假設</td><td>先驗機率 p(H)</td><td>似然性 p(D|H)</td><td>聯合機率 p(H)p(D|H)</td><td>後驗機率 p(H|D)</td></tr>
<tr><td>A</td><td>0.5</td><td>20*20</td><td>200</td><td>200/270</td></tr>
<tr><td>B</td><td>0.5</td><td>14*10</td><td>70</td><td>70/270</td></tr>
</table>

第一欄是先驗機率。依據問題描述，我們設定為 p(A) = p(B) = 0.5。

第二欄是似然性。

* 如果假設 A 成立，則黃色 M&M 從 1994 年的巧克力包抽出來的機率 0.2 ，綠色 M&M 從 1996 年的巧克力包抽出來的機率是 0.2。
* 如果假設 B 成立，則黃色 M&M 從 1996 年的巧克力包抽出來的機率 0.14 ，綠色 M&M 從 1994 年的巧克力包抽出來的機率是 0.1。

因為分別從兩包中選取的機率為**獨立**，因次機率 p(D|H) 為兩個抽出機率各自相乘。

第三欄只是第一、二欄的相乘。而此欄的加總為 270 就是正規化常數（normalizing constant）。

最後一欄表示後驗機率，也是我們想要知道的機率。就只要把第三欄除以正規劃常數即可。

就這樣，很簡單對吧？

但你可能會覺得其中一個細節很奇怪。我在 p(D|H) 是用百分比的方式表示，而不是機率。這與原機率相差了 10000 倍，但因為最後我們會除以正規化常數，所以不會影響結果。

當這組假設是互相獨立，完全窮盡的情況下，你可以因為便利性將似然性（likelihood）乘以任何的因子，只要對整欄都乘上相同的因子即可。


